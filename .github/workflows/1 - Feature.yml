name: Feature Branch PR Workflow

on:
  push:
    branches:
      - "feature/*"

jobs:
  create-pull-request:
    runs-on: ubuntu-latest
    concurrency:
      group: ${{ github.ref }}
      cancel-in-progress: true
    steps:
      # Checkout do repositório
      - name: Checkout repository
        uses: actions/checkout@v3

      # Configuração do Cache
      - name: Cache Node Modules
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-node-

      # Criação da Pull Request
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }} # Token para autenticação
          commit-message: 'Automated PR creation for feature branch'
          title: 'Feature Update: ${{ github.ref_name }}'
          body: |
            Esta PR foi criada automaticamente para a branch `${{ github.ref_name }}`.
            Por favor, revise as alterações antes de realizar o merge.
          base: development # Branch alvo para merge (altere conforme necessário)
          branch: ${{ github.ref_name }} # Nome da branch de origem
          draft: false # Certifique-se de que a PR não será criada como rascunho
